#!/bin/sh

set -e

[ ! -f "/usr/bin/rsync" ] && echo "This script requires rsync to run!" && exit 1
[ "$#" -ne 1 ] && echo "You need to provide a destination directory." && exit 1

DST="$(realpath "$1")"

[ ! -d "$DST" ] && mkdir -p "$DST"

backup() {
	DIR_NAME="$(dirname "$1" | cut -d "/" -f 4,5,6,7,8,9,10)"
	mkdir -p "$DST/$DIR_NAME"
	rsync --archive --recursive --verbose "$1" "$DST/$DIR_NAME"
}

# backup "$HOME/.config/discord/settings.json"
# backup "$HOME/.config/gtk-2.0/gtkrc-2.0"
# backup "$HOME/.config/gtk-3.0/settings.ini"
# backup "$HOME/.config/gtk-4.0/settings.ini"
backup "$HOME/.config/fish/config.fish"
backup "$HOME/.config/kitty/kitty.conf"
backup "$HOME/.config/mpv/mpv.conf"
backup "$HOME/.config/nvim"
backup "$HOME/.config/python/pythonrc"
backup "$HOME/.config/ruff/ruff.toml"
backup "$HOME/.config/sh"
backup "$HOME/.config/wget/wgetrc"
backup "$HOME/.librewolf/librewolf.overrides.cfg"
backup "$HOME/.local/bin"
backup "$HOME/.local/share/default/index.theme"
